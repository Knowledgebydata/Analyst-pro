<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0d6efd">
<title>ZorgAnalyst Pro Mobile</title>
<link rel="manifest" href="./manifest.json">
<link rel="apple-touch-icon" href="./icons/icon-192x192.png">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
:root{--primary:#0d6efd;--primary-dark:#0b5ed7;--primary-light:#6ea8fe;--accent:#198754;--success:#198754;--warning:#ffc107;--danger:#dc3545;--dark:#1a1a2e;--light:#f8f9fa;--gray:#6c757d;--gray-light:#dee2e6}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:var(--light);min-height:100vh;color:var(--dark)}
.hidden{display:none!important}
.auth-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--dark),#16213e);padding:20px}
.auth-box{background:rgba(255,255,255,0.05);padding:40px 30px;border-radius:24px;width:100%;max-width:360px;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1);text-align:center}
.auth-logo{width:80px;height:80px;background:var(--primary);border-radius:20px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:2rem;color:white}
.auth-box h1{color:var(--primary-light);font-size:1.5rem;margin-bottom:8px}
.auth-box p{color:rgba(255,255,255,0.6);margin-bottom:30px;font-size:0.9rem}
.auth-input{width:100%;padding:15px;margin-bottom:15px;border:2px solid rgba(255,255,255,0.1);border-radius:12px;background:rgba(0,0,0,0.3);color:white;font-size:1rem;text-align:center}
.auth-input::placeholder{color:rgba(255,255,255,0.4)}
.auth-input:focus{outline:none;border-color:var(--primary)}
.pin-dots{display:flex;justify-content:center;gap:15px;margin:30px 0}
.pin-dot{width:18px;height:18px;border-radius:50%;border:2px solid var(--primary-light);background:transparent;transition:all 0.2s}
.pin-dot.filled{background:var(--primary-light);transform:scale(1.1)}
.numpad{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:280px;margin:0 auto}
.numpad-btn{aspect-ratio:1;border:none;border-radius:50%;font-size:1.5rem;font-weight:600;cursor:pointer;background:rgba(255,255,255,0.1);color:white;transition:all 0.15s}
.numpad-btn:hover{background:rgba(255,255,255,0.2)}
.numpad-btn:active{transform:scale(0.95)}
.numpad-btn.action{background:var(--primary)}
.auth-error{color:var(--danger);font-size:0.85rem;margin-top:15px;min-height:20px}
@keyframes shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-10px)}40%,80%{transform:translateX(10px)}}
.shake{animation:shake 0.4s ease-in-out}
.app-container{display:none}
.app-container.active{display:block}
.security-bar{background:var(--primary);color:white;padding:8px 15px;font-size:0.75rem;text-align:center;position:fixed;top:0;left:0;right:0;z-index:1000}
.app-header{background:linear-gradient(135deg,var(--dark),#16213e);color:white;padding:25px 20px 20px;padding-top:50px;text-align:center}
.app-header h1{font-size:1.3rem;color:var(--primary-light);margin-bottom:5px}
.app-header .user-info{color:rgba(255,255,255,0.7);font-size:0.85rem}
.nav-tabs{display:flex;background:white;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:33px;z-index:100}
.nav-tab{flex:1;padding:12px 8px;text-align:center;border:none;background:none;cursor:pointer;font-size:0.7rem;color:var(--gray);border-bottom:3px solid transparent}
.nav-tab.active{color:var(--primary);border-bottom-color:var(--primary)}
.nav-tab i{display:block;font-size:1.1rem;margin-bottom:3px}
.main-content{padding:15px;padding-bottom:100px;max-width:600px;margin:0 auto}
.tab-content{display:none}
.tab-content.active{display:block}
.card{background:white;border-radius:16px;padding:20px;margin-bottom:15px;box-shadow:0 2px 12px rgba(0,0,0,0.08)}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid var(--gray-light)}
.card-title{font-size:1rem;font-weight:600;display:flex;align-items:center;gap:8px}
.card-title i{color:var(--primary)}
.stats-display{background:linear-gradient(135deg,var(--dark),#16213e);color:white;border-radius:16px;padding:20px;margin-bottom:15px}
.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}
.stat-item{text-align:center}
.stat-item .label{font-size:0.7rem;opacity:0.7;margin-bottom:4px}
.stat-item .value{font-size:1.3rem;font-weight:bold}
.stat-item.highlight .value{color:var(--primary-light)}
.gps-status{display:flex;align-items:center;gap:10px;padding:12px 15px;border-radius:10px;margin-bottom:15px;font-size:0.85rem}
.gps-status.loading{background:#e3f2fd;color:#1565c0}
.gps-status.success{background:#d4edda;color:#155724}
.gps-status.error{background:#f8d7da;color:#721c24}
.gps-status i{font-size:1.1rem}
.form-group{margin-bottom:15px}
.form-label{display:block;font-size:0.85rem;font-weight:600;margin-bottom:6px}
.form-control{width:100%;padding:12px 15px;border:2px solid var(--gray-light);border-radius:10px;font-size:1rem}
.form-control:focus{outline:none;border-color:var(--primary)}
textarea.form-control{min-height:120px;resize:vertical}
.tag-group{display:flex;flex-wrap:wrap;gap:8px}
.tag{display:inline-flex;align-items:center;padding:8px 15px;border:2px solid var(--gray-light);border-radius:20px;font-size:0.85rem;cursor:pointer;transition:all 0.2s}
.tag.active{background:var(--primary);border-color:var(--primary);color:white}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 20px;border:none;border-radius:10px;font-size:0.9rem;font-weight:600;cursor:pointer}
.btn-primary{background:var(--primary);color:white}
.btn-success{background:var(--success);color:white}
.btn-danger{background:var(--danger);color:white}
.btn-outline{background:white;border:2px solid var(--gray-light);color:var(--dark)}
.btn-block{width:100%}
.btn-lg{padding:15px 25px;font-size:1rem}
.melding-item{padding:15px;border-radius:12px;background:var(--light);margin-bottom:10px}
.melding-item-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.melding-item-bedrijf{font-weight:600;display:flex;align-items:center;gap:8px}
.melding-item-bedrijf i{color:var(--primary)}
.melding-item-date{font-size:0.8rem;color:var(--gray)}
.melding-item-types{display:flex;flex-wrap:wrap;gap:5px;margin-top:8px}
.melding-type-badge{font-size:0.7rem;padding:3px 8px;background:var(--primary);color:white;border-radius:10px}
.empty-state{text-align:center;padding:40px 20px;color:var(--gray)}
.empty-state i{font-size:3rem;margin-bottom:15px;opacity:0.5}
.toast-container{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);z-index:9999}
.toast{background:var(--dark);color:white;padding:12px 24px;border-radius:10px;font-size:0.9rem;animation:slideUp 0.3s ease}
.toast.success{background:var(--success)}
.toast.error{background:var(--danger)}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div id="login-screen" class="auth-screen">
<div class="auth-box">
<div class="auth-logo"><i class="fas fa-heartbeat"></i></div>
<h1>ZorgAnalyst Pro</h1>
<p>Voer uw PIN in om door te gaan</p>
<div class="pin-dots"><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div></div>
<div class="numpad">
<button class="numpad-btn" onclick="Auth.digit(1)">1</button>
<button class="numpad-btn" onclick="Auth.digit(2)">2</button>
<button class="numpad-btn" onclick="Auth.digit(3)">3</button>
<button class="numpad-btn" onclick="Auth.digit(4)">4</button>
<button class="numpad-btn" onclick="Auth.digit(5)">5</button>
<button class="numpad-btn" onclick="Auth.digit(6)">6</button>
<button class="numpad-btn" onclick="Auth.digit(7)">7</button>
<button class="numpad-btn" onclick="Auth.digit(8)">8</button>
<button class="numpad-btn" onclick="Auth.digit(9)">9</button>
<button class="numpad-btn action" onclick="Auth.clear()"><i class="fas fa-times"></i></button>
<button class="numpad-btn" onclick="Auth.digit(0)">0</button>
<button class="numpad-btn action" onclick="Auth.backspace()"><i class="fas fa-backspace"></i></button>
</div>
<div id="login-error" class="auth-error"></div>
</div>
</div>
<div id="setup-screen" class="auth-screen hidden">
<div class="auth-box">
<div class="auth-logo"><i class="fas fa-user-plus"></i></div>
<h1>Welkom</h1>
<p>Stel uw account in</p>
<input type="text" id="setup-name" class="auth-input" placeholder="Uw naam" maxlength="50">
<input type="password" id="setup-pin" class="auth-input" placeholder="Kies 4-cijferige PIN" maxlength="4" inputmode="numeric">
<input type="password" id="setup-pin-confirm" class="auth-input" placeholder="Bevestig PIN" maxlength="4" inputmode="numeric">
<button class="numpad-btn action" style="width:100%;aspect-ratio:auto;padding:15px;border-radius:12px;font-size:1rem" onclick="Auth.completeSetup()"><i class="fas fa-check"></i> Account Aanmaken</button>
<div id="setup-error" class="auth-error"></div>
</div>
</div>
<div id="app-container" class="app-container">
<div class="security-bar"><i class="fas fa-shield-alt"></i> Beveiligde omgeving - Data blijft lokaal</div>
<header class="app-header">
<h1><i class="fas fa-heartbeat"></i> ZorgAnalyst Pro</h1>
<div class="user-info">Welkom, <span id="display-user">Gebruiker</span></div>
</header>
<nav class="nav-tabs">
<button class="nav-tab active" data-tab="dashboard"><i class="fas fa-home"></i>Dashboard</button>
<button class="nav-tab" data-tab="new"><i class="fas fa-plus-circle"></i>Nieuwe</button>
<button class="nav-tab" data-tab="list"><i class="fas fa-list"></i>Meldingen</button>
<button class="nav-tab" data-tab="settings"><i class="fas fa-cog"></i>Instellingen</button>
</nav>
<main class="main-content">
<div id="tab-dashboard" class="tab-content active">
<div class="stats-display">
<div class="stats-grid">
<div class="stat-item highlight"><div class="label">Meldingen</div><div class="value" id="stat-count">0</div></div>
<div class="stat-item"><div class="label">Unieke Bedrijven</div><div class="value" id="stat-bedrijven">0</div></div>
</div>
</div>
<div class="card"><div class="card-header"><span class="card-title"><i class="fas fa-history"></i> Recente Meldingen</span></div><div id="recent-list"></div></div>
</div>
<div id="tab-new" class="tab-content">
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-plus-circle"></i> Nieuwe Melding</span></div>
<div id="gps-status" class="gps-status loading"><i class="fas fa-spinner fa-spin"></i> <span>Locatie ophalen...</span></div>
<div class="form-group"><label class="form-label">Bedrijfsnaam *</label><input type="text" id="melding-bedrijf" class="form-control" placeholder="Naam zorgorganisatie"></div>
<div class="form-group"><label class="form-label">KVK-nummer</label><input type="text" id="melding-kvk" class="form-control" placeholder="8 cijfers" maxlength="8"></div>
<div class="form-group"><label class="form-label">Adres</label><input type="text" id="melding-adres" class="form-control" placeholder="Straat, huisnummer, plaats"></div>
<div class="form-group"><label class="form-label">Type fraude</label>
<div class="tag-group" id="fraude-types">
<div class="tag" data-type="declaratiefraude">Declaratiefraude</div>
<div class="tag" data-type="pgb-fraude">PGB-fraude</div>
<div class="tag" data-type="kwaliteit">Kwaliteitsprobleem</div>
<div class="tag" data-type="zorgfraude">Zorgfraude</div>
<div class="tag" data-type="overig">Overig</div>
</div></div>
<div class="form-group"><label class="form-label">Omschrijving *</label><textarea id="melding-omschrijving" class="form-control" placeholder="Beschrijf de situatie"></textarea></div>
<button class="btn btn-success btn-block btn-lg" onclick="saveMelding()"><i class="fas fa-save"></i> Melding Opslaan</button>
</div>
</div>
<div id="tab-list" class="tab-content">
<div class="card"><div class="card-header"><span class="card-title"><i class="fas fa-list"></i> Alle Meldingen</span></div><div id="all-list"></div></div>
</div>
<div id="tab-settings" class="tab-content">
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-user"></i> Profiel</span></div>
<div class="form-group"><label class="form-label">Naam</label><input type="text" id="settings-name" class="form-control"></div>
<button class="btn btn-primary btn-block" onclick="saveSettings()"><i class="fas fa-save"></i> Opslaan</button>
</div>
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-download"></i> Export</span></div>
<button class="btn btn-outline btn-block" onclick="exportJSON()"><i class="fas fa-file-code"></i> Export JSON</button>
</div>
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-shield-alt"></i> Beveiliging</span></div>
<button class="btn btn-outline btn-block" onclick="changePin()" style="margin-bottom:10px"><i class="fas fa-key"></i> PIN Wijzigen</button>
<button class="btn btn-danger btn-block" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Uitloggen</button>
</div>
<div class="card"><p style="font-size:0.85rem;color:var(--gray);text-align:center"><strong>ZorgAnalyst Pro Mobile</strong><br>Versie 1.0.0 PWA<br><br>© 2025 Knowledge by Data</p></div>
</div>
</main>
</div>
<div id="toast-container" class="toast-container"></div>
<script>
'use strict';
const K={PIN:'zorg_pin',USER:'zorg_user',DATA:'zorg_data'};
const STATE={pin:'',user:null,meldingen:[],selectedTypes:[],gps:null};
const esc=t=>{if(!t)return'';const d=document.createElement('div');d.textContent=String(t);return d.innerHTML};
const toast=(m,t='info')=>{const c=document.getElementById('toast-container');const e=document.createElement('div');e.className='toast '+t;e.textContent=m;c.appendChild(e);setTimeout(()=>e.remove(),3000)};
const download=(content,name,type)=>{const b=new Blob([content],{type});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)};

const Auth={
init(){const p=localStorage.getItem(K.PIN);const u=localStorage.getItem(K.USER);if(p&&u){this.showLogin()}else{this.showSetup()}},
showLogin(){document.getElementById('login-screen').classList.remove('hidden');document.getElementById('setup-screen').classList.add('hidden');document.getElementById('app-container').classList.remove('active');this.clearPin()},
showSetup(){document.getElementById('login-screen').classList.add('hidden');document.getElementById('setup-screen').classList.remove('hidden');document.getElementById('app-container').classList.remove('active')},
showApp(){document.getElementById('login-screen').classList.add('hidden');document.getElementById('setup-screen').classList.add('hidden');document.getElementById('app-container').classList.add('active');STATE.user=localStorage.getItem(K.USER);document.getElementById('display-user').textContent=esc(STATE.user);document.getElementById('settings-name').value=STATE.user;loadData();updateUI();getGPS()},
digit(n){if(STATE.pin.length>=4)return;STATE.pin+=n;this.updateDots();if(STATE.pin.length===4)setTimeout(()=>this.verifyPin(),100)},
backspace(){STATE.pin=STATE.pin.slice(0,-1);this.updateDots()},
clear(){STATE.pin='';this.updateDots();document.getElementById('login-error').textContent=''},
updateDots(){document.querySelectorAll('.pin-dot').forEach((d,i)=>d.classList.toggle('filled',i<STATE.pin.length))},
verifyPin(){const s=localStorage.getItem(K.PIN);if(STATE.pin===s){this.showApp()}else{document.getElementById('login-error').textContent='Onjuiste PIN';document.querySelector('#login-screen .auth-box').classList.add('shake');setTimeout(()=>{document.querySelector('#login-screen .auth-box').classList.remove('shake');this.clear()},400)}},
clearPin(){STATE.pin='';this.updateDots();document.getElementById('login-error').textContent=''},
completeSetup(){const n=document.getElementById('setup-name').value.trim();const p=document.getElementById('setup-pin').value;const c=document.getElementById('setup-pin-confirm').value;const e=document.getElementById('setup-error');if(!n){e.textContent='Voer uw naam in';return}if(!/^\d{4}$/.test(p)){e.textContent='PIN moet 4 cijfers zijn';return}if(p!==c){e.textContent='PIN komt niet overeen';return}localStorage.setItem(K.PIN,p);localStorage.setItem(K.USER,n);localStorage.setItem(K.DATA,'[]');this.showApp();toast('Account aangemaakt!','success')}
};

function getGPS(){const st=document.getElementById('gps-status');if(!navigator.geolocation){st.className='gps-status error';st.innerHTML='<i class="fas fa-times-circle"></i> GPS niet beschikbaar';return}
navigator.geolocation.getCurrentPosition(p=>{STATE.gps={lat:p.coords.latitude,lng:p.coords.longitude,accuracy:p.coords.accuracy};st.className='gps-status success';st.innerHTML=`<i class="fas fa-check-circle"></i> Locatie: ${STATE.gps.lat.toFixed(5)}, ${STATE.gps.lng.toFixed(5)}`},e=>{st.className='gps-status error';st.innerHTML='<i class="fas fa-exclamation-circle"></i> Locatie niet beschikbaar'},{enableHighAccuracy:true,timeout:10000,maximumAge:60000})}
function loadData(){try{const d=localStorage.getItem(K.DATA);STATE.meldingen=d?JSON.parse(d):[]}catch(e){STATE.meldingen=[]}}
function saveData(){localStorage.setItem(K.DATA,JSON.stringify(STATE.meldingen))}
function switchTab(t){document.querySelectorAll('.nav-tab').forEach(n=>n.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(n=>n.classList.remove('active'));document.querySelector(`.nav-tab[data-tab="${t}"]`).classList.add('active');document.getElementById('tab-'+t).classList.add('active');if(t==='new')getGPS()}
function updateUI(){updateStats();updateRecent();updateAll()}
function updateStats(){document.getElementById('stat-count').textContent=STATE.meldingen.length;const unique=new Set(STATE.meldingen.map(m=>m.bedrijf.toLowerCase())).size;document.getElementById('stat-bedrijven').textContent=unique}
function renderMelding(m){const dt=new Date(m.createdAt).toLocaleDateString('nl-NL',{day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'});const types=m.types.map(t=>`<span class="melding-type-badge">${esc(t)}</span>`).join('');return`<div class="melding-item"><div class="melding-item-header"><span class="melding-item-bedrijf"><i class="fas fa-building"></i> ${esc(m.bedrijf)}</span><span class="melding-item-date">${dt}</span></div>${m.kvk?`<div style="font-size:0.8rem;color:var(--gray)">KVK: ${esc(m.kvk)}</div>`:''}<div class="melding-item-types">${types}</div></div>`}
function updateRecent(){const c=document.getElementById('recent-list');const r=STATE.meldingen.slice(0,5);if(!r.length){c.innerHTML='<div class="empty-state"><i class="fas fa-clipboard-list"></i><p>Nog geen meldingen</p></div>';return}c.innerHTML=r.map(renderMelding).join('')}
function updateAll(){const c=document.getElementById('all-list');if(!STATE.meldingen.length){c.innerHTML='<div class="empty-state"><i class="fas fa-clipboard-list"></i><p>Nog geen meldingen</p></div>';return}c.innerHTML=STATE.meldingen.map(renderMelding).join('')}
function saveMelding(){const bedrijf=document.getElementById('melding-bedrijf').value.trim();const kvk=document.getElementById('melding-kvk').value.trim();const adres=document.getElementById('melding-adres').value.trim();const omschrijving=document.getElementById('melding-omschrijving').value.trim();if(!bedrijf){toast('Bedrijfsnaam verplicht','error');return}if(!omschrijving){toast('Omschrijving verplicht','error');return}if(!STATE.selectedTypes.length){toast('Selecteer minimaal één type','error');return}const melding={id:Date.now().toString(36)+Math.random().toString(36).substr(2,5),bedrijf,kvk,adres,types:STATE.selectedTypes,omschrijving,gps:STATE.gps,createdAt:new Date().toISOString()};STATE.meldingen.unshift(melding);saveData();updateUI();document.getElementById('melding-bedrijf').value='';document.getElementById('melding-kvk').value='';document.getElementById('melding-adres').value='';document.getElementById('melding-omschrijving').value='';STATE.selectedTypes=[];document.querySelectorAll('#fraude-types .tag').forEach(t=>t.classList.remove('active'));toast('Melding opgeslagen','success');switchTab('dashboard')}
function exportJSON(){if(!STATE.meldingen.length){toast('Geen data','error');return}const data={type:'zorganalyst',version:'1.0.0',medewerker:STATE.user,exportDatum:new Date().toISOString(),meldingen:STATE.meldingen};download(JSON.stringify(data,null,2),`zorganalyst_${new Date().toISOString().split('T')[0]}.json`,'application/json');toast('Geëxporteerd','success')}
function saveSettings(){const n=document.getElementById('settings-name').value.trim();if(!n){toast('Naam verplicht','error');return}localStorage.setItem(K.USER,n);STATE.user=n;document.getElementById('display-user').textContent=esc(n);toast('Opgeslagen','success')}
function changePin(){const p=prompt('Nieuwe 4-cijferige PIN:');if(p&&/^\d{4}$/.test(p)){localStorage.setItem(K.PIN,p);toast('PIN gewijzigd','success')}else if(p){toast('PIN moet 4 cijfers zijn','error')}}
function logout(){if(confirm('Uitloggen?')){Auth.showLogin();toast('Uitgelogd','info')}}
document.addEventListener('DOMContentLoaded',()=>{
Auth.init();
document.querySelectorAll('.nav-tab').forEach(t=>t.addEventListener('click',()=>switchTab(t.dataset.tab)));
document.querySelectorAll('#fraude-types .tag').forEach(t=>t.addEventListener('click',()=>{t.classList.toggle('active');const type=t.dataset.type;if(t.classList.contains('active')){STATE.selectedTypes.push(type)}else{STATE.selectedTypes=STATE.selectedTypes.filter(x=>x!==type)}}))});
if('serviceWorker' in navigator){navigator.serviceWorker.register('./sw.js').catch(e=>console.error('SW:',e))}
</script>
</body>
</html>
