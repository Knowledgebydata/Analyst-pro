<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#1e3a5f">
<title>BIBOB Interview Pro</title>
<link rel="manifest" href="./manifest.json">
<link rel="apple-touch-icon" href="./icons/icon-192x192.png">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
:root{--primary:#1e3a5f;--primary-dark:#152a45;--primary-light:#3d6a99;--accent:#17a2b8;--success:#28a745;--warning:#ffc107;--danger:#dc3545;--dark:#1a1a2e;--light:#f8f9fa;--gray:#6c757d;--gray-light:#dee2e6}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:var(--light);min-height:100vh;color:var(--dark)}
.hidden{display:none!important}
.auth-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--dark),#16213e);padding:20px}
.auth-box{background:rgba(255,255,255,0.05);padding:40px 30px;border-radius:24px;width:100%;max-width:360px;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1);text-align:center}
.auth-logo{width:80px;height:80px;background:var(--primary);border-radius:20px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:2rem;color:white}
.auth-box h1{color:var(--primary-light);font-size:1.5rem;margin-bottom:8px}
.auth-box p{color:rgba(255,255,255,0.6);margin-bottom:30px;font-size:0.9rem}
.auth-input{width:100%;padding:15px;margin-bottom:15px;border:2px solid rgba(255,255,255,0.1);border-radius:12px;background:rgba(0,0,0,0.3);color:white;font-size:1rem;text-align:center}
.auth-input::placeholder{color:rgba(255,255,255,0.4)}
.auth-input:focus{outline:none;border-color:var(--primary)}
.pin-dots{display:flex;justify-content:center;gap:15px;margin:30px 0}
.pin-dot{width:18px;height:18px;border-radius:50%;border:2px solid var(--primary-light);background:transparent;transition:all 0.2s}
.pin-dot.filled{background:var(--primary-light);transform:scale(1.1)}
.numpad{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:280px;margin:0 auto}
.numpad-btn{aspect-ratio:1;border:none;border-radius:50%;font-size:1.5rem;font-weight:600;cursor:pointer;background:rgba(255,255,255,0.1);color:white;transition:all 0.15s}
.numpad-btn:hover{background:rgba(255,255,255,0.2)}
.numpad-btn:active{transform:scale(0.95)}
.numpad-btn.action{background:var(--primary)}
.auth-error{color:var(--danger);font-size:0.85rem;margin-top:15px;min-height:20px}
@keyframes shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-10px)}40%,80%{transform:translateX(10px)}}
.shake{animation:shake 0.4s ease-in-out}
.app-container{display:none}
.app-container.active{display:block}
.security-bar{background:var(--primary);color:white;padding:8px 15px;font-size:0.75rem;text-align:center;position:fixed;top:0;left:0;right:0;z-index:1000}
.app-header{background:linear-gradient(135deg,var(--dark),#16213e);color:white;padding:25px 20px 20px;padding-top:50px;text-align:center}
.app-header h1{font-size:1.3rem;color:var(--primary-light);margin-bottom:5px}
.app-header .user-info{color:rgba(255,255,255,0.7);font-size:0.85rem}
.nav-tabs{display:flex;background:white;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:33px;z-index:100}
.nav-tab{flex:1;padding:12px 8px;text-align:center;border:none;background:none;cursor:pointer;font-size:0.7rem;color:var(--gray);border-bottom:3px solid transparent}
.nav-tab.active{color:var(--primary);border-bottom-color:var(--primary)}
.nav-tab i{display:block;font-size:1.1rem;margin-bottom:3px}
.main-content{padding:15px;padding-bottom:100px;max-width:600px;margin:0 auto}
.tab-content{display:none}
.tab-content.active{display:block}
.card{background:white;border-radius:16px;padding:20px;margin-bottom:15px;box-shadow:0 2px 12px rgba(0,0,0,0.08)}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid var(--gray-light)}
.card-title{font-size:1rem;font-weight:600;display:flex;align-items:center;gap:8px}
.card-title i{color:var(--primary)}
.stats-display{background:linear-gradient(135deg,var(--dark),#16213e);color:white;border-radius:16px;padding:20px;margin-bottom:15px}
.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}
.stat-item{text-align:center}
.stat-item .label{font-size:0.7rem;opacity:0.7;margin-bottom:4px}
.stat-item .value{font-size:1.3rem;font-weight:bold}
.stat-item.highlight .value{color:var(--primary-light)}
.browser-warning{background:var(--warning);color:#856404;padding:12px 15px;border-radius:10px;margin-bottom:15px;font-size:0.85rem;display:flex;align-items:center;gap:10px}
.browser-warning i{font-size:1.2rem}
.form-group{margin-bottom:15px}
.form-label{display:block;font-size:0.85rem;font-weight:600;margin-bottom:6px}
.form-control{width:100%;padding:12px 15px;border:2px solid var(--gray-light);border-radius:10px;font-size:1rem}
.form-control:focus{outline:none;border-color:var(--primary)}
textarea.form-control{min-height:200px;resize:vertical;font-family:inherit}
.record-btn{width:100%;padding:20px;border:none;border-radius:16px;font-size:1.1rem;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:12px;transition:all 0.3s}
.record-btn.idle{background:var(--primary);color:white}
.record-btn.recording{background:var(--danger);color:white;animation:pulse 1.5s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}
.word-count{text-align:center;font-size:0.85rem;color:var(--gray);margin-top:10px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 20px;border:none;border-radius:10px;font-size:0.9rem;font-weight:600;cursor:pointer}
.btn-primary{background:var(--primary);color:white}
.btn-success{background:var(--success);color:white}
.btn-danger{background:var(--danger);color:white}
.btn-outline{background:white;border:2px solid var(--gray-light);color:var(--dark)}
.btn-block{width:100%}
.btn-lg{padding:15px 25px;font-size:1rem}
.interview-item{padding:15px;border-radius:12px;background:var(--light);margin-bottom:10px}
.interview-item-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.interview-item-name{font-weight:600;display:flex;align-items:center;gap:8px}
.interview-item-name i{color:var(--primary)}
.interview-item-date{font-size:0.8rem;color:var(--gray)}
.interview-item-meta{font-size:0.8rem;color:var(--gray)}
.empty-state{text-align:center;padding:40px 20px;color:var(--gray)}
.empty-state i{font-size:3rem;margin-bottom:15px;opacity:0.5}
.toast-container{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);z-index:9999}
.toast{background:var(--dark);color:white;padding:12px 24px;border-radius:10px;font-size:0.9rem;animation:slideUp 0.3s ease}
.toast.success{background:var(--success)}
.toast.error{background:var(--danger)}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div id="login-screen" class="auth-screen">
<div class="auth-box">
<div class="auth-logo"><i class="fas fa-microphone-alt"></i></div>
<h1>BIBOB Interview Pro</h1>
<p>Voer uw PIN in om door te gaan</p>
<div class="pin-dots"><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div></div>
<div class="numpad">
<button class="numpad-btn" onclick="Auth.digit(1)">1</button>
<button class="numpad-btn" onclick="Auth.digit(2)">2</button>
<button class="numpad-btn" onclick="Auth.digit(3)">3</button>
<button class="numpad-btn" onclick="Auth.digit(4)">4</button>
<button class="numpad-btn" onclick="Auth.digit(5)">5</button>
<button class="numpad-btn" onclick="Auth.digit(6)">6</button>
<button class="numpad-btn" onclick="Auth.digit(7)">7</button>
<button class="numpad-btn" onclick="Auth.digit(8)">8</button>
<button class="numpad-btn" onclick="Auth.digit(9)">9</button>
<button class="numpad-btn action" onclick="Auth.clear()"><i class="fas fa-times"></i></button>
<button class="numpad-btn" onclick="Auth.digit(0)">0</button>
<button class="numpad-btn action" onclick="Auth.backspace()"><i class="fas fa-backspace"></i></button>
</div>
<div id="login-error" class="auth-error"></div>
</div>
</div>
<div id="setup-screen" class="auth-screen hidden">
<div class="auth-box">
<div class="auth-logo"><i class="fas fa-user-plus"></i></div>
<h1>Welkom</h1>
<p>Stel uw account in</p>
<input type="text" id="setup-name" class="auth-input" placeholder="Uw naam" maxlength="50">
<input type="password" id="setup-pin" class="auth-input" placeholder="Kies 4-cijferige PIN" maxlength="4" inputmode="numeric">
<input type="password" id="setup-pin-confirm" class="auth-input" placeholder="Bevestig PIN" maxlength="4" inputmode="numeric">
<button class="numpad-btn action" style="width:100%;aspect-ratio:auto;padding:15px;border-radius:12px;font-size:1rem" onclick="Auth.completeSetup()"><i class="fas fa-check"></i> Account Aanmaken</button>
<div id="setup-error" class="auth-error"></div>
</div>
</div>
<div id="app-container" class="app-container">
<div class="security-bar"><i class="fas fa-shield-alt"></i> Beveiligde omgeving - Data blijft lokaal</div>
<header class="app-header">
<h1><i class="fas fa-microphone-alt"></i> BIBOB Interview Pro</h1>
<div class="user-info">Welkom, <span id="display-user">Gebruiker</span></div>
</header>
<nav class="nav-tabs">
<button class="nav-tab active" data-tab="dashboard"><i class="fas fa-home"></i>Dashboard</button>
<button class="nav-tab" data-tab="interview"><i class="fas fa-microphone"></i>Interview</button>
<button class="nav-tab" data-tab="list"><i class="fas fa-list"></i>Interviews</button>
<button class="nav-tab" data-tab="settings"><i class="fas fa-cog"></i>Instellingen</button>
</nav>
<main class="main-content">
<div id="tab-dashboard" class="tab-content active">
<div class="stats-display">
<div class="stats-grid">
<div class="stat-item highlight"><div class="label">Interviews</div><div class="value" id="stat-count">0</div></div>
<div class="stat-item"><div class="label">Totaal Woorden</div><div class="value" id="stat-words">0</div></div>
</div>
</div>
<div class="card"><div class="card-header"><span class="card-title"><i class="fas fa-history"></i> Recente Interviews</span></div><div id="recent-list"></div></div>
</div>
<div id="tab-interview" class="tab-content">
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-microphone"></i> Nieuw Interview</span></div>
<div id="browser-warning" class="browser-warning hidden"><i class="fas fa-exclamation-triangle"></i> Spraakherkenning werkt het best in Chrome of Edge</div>
<div class="form-group"><label class="form-label">Naam geïnterviewde *</label><input type="text" id="interview-naam" class="form-control" placeholder="Volledige naam"></div>
<div class="form-group"><label class="form-label">Onderwerp</label><input type="text" id="interview-onderwerp" class="form-control" placeholder="Interview onderwerp"></div>
<button id="record-btn" class="record-btn idle" onclick="toggleRecording()"><i class="fas fa-microphone"></i> <span>Start Opname</span></button>
<div class="word-count" id="word-count">0 woorden</div>
<div class="form-group" style="margin-top:15px"><label class="form-label">Transcriptie</label><textarea id="interview-transcript" class="form-control" placeholder="Transcript verschijnt hier..."></textarea></div>
<button class="btn btn-success btn-block btn-lg" onclick="saveInterview()"><i class="fas fa-save"></i> Interview Opslaan</button>
</div>
</div>
<div id="tab-list" class="tab-content">
<div class="card"><div class="card-header"><span class="card-title"><i class="fas fa-list"></i> Alle Interviews</span></div><div id="all-list"></div></div>
</div>
<div id="tab-settings" class="tab-content">
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-user"></i> Profiel</span></div>
<div class="form-group"><label class="form-label">Naam</label><input type="text" id="settings-name" class="form-control"></div>
<button class="btn btn-primary btn-block" onclick="saveSettings()"><i class="fas fa-save"></i> Opslaan</button>
</div>
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-download"></i> Export</span></div>
<button class="btn btn-outline btn-block" onclick="exportJSON()"><i class="fas fa-file-code"></i> Export JSON</button>
</div>
<div class="card">
<div class="card-header"><span class="card-title"><i class="fas fa-shield-alt"></i> Beveiliging</span></div>
<button class="btn btn-outline btn-block" onclick="changePin()" style="margin-bottom:10px"><i class="fas fa-key"></i> PIN Wijzigen</button>
<button class="btn btn-danger btn-block" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Uitloggen</button>
</div>
<div class="card"><p style="font-size:0.85rem;color:var(--gray);text-align:center"><strong>BIBOB Interview Pro</strong><br>Versie 1.0.0 PWA<br><br>© 2025 Knowledge by Data</p></div>
</div>
</main>
</div>
<div id="toast-container" class="toast-container"></div>
<script>
'use strict';
const K={PIN:'bibob_pin',USER:'bibob_user',DATA:'bibob_data'};
const STATE={pin:'',user:null,interviews:[],recording:false,recognition:null};
const esc=t=>{if(!t)return'';const d=document.createElement('div');d.textContent=String(t);return d.innerHTML};
const toast=(m,t='info')=>{const c=document.getElementById('toast-container');const e=document.createElement('div');e.className='toast '+t;e.textContent=m;c.appendChild(e);setTimeout(()=>e.remove(),3000)};
const download=(content,name,type)=>{const b=new Blob([content],{type});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)};
const countWords=t=>t.trim()?t.trim().split(/\s+/).length:0;

const Auth={
init(){const p=localStorage.getItem(K.PIN);const u=localStorage.getItem(K.USER);if(p&&u){this.showLogin()}else{this.showSetup()}},
showLogin(){document.getElementById('login-screen').classList.remove('hidden');document.getElementById('setup-screen').classList.add('hidden');document.getElementById('app-container').classList.remove('active');this.clearPin()},
showSetup(){document.getElementById('login-screen').classList.add('hidden');document.getElementById('setup-screen').classList.remove('hidden');document.getElementById('app-container').classList.remove('active')},
showApp(){document.getElementById('login-screen').classList.add('hidden');document.getElementById('setup-screen').classList.add('hidden');document.getElementById('app-container').classList.add('active');STATE.user=localStorage.getItem(K.USER);document.getElementById('display-user').textContent=esc(STATE.user);document.getElementById('settings-name').value=STATE.user;loadData();updateUI();initSpeech()},
digit(n){if(STATE.pin.length>=4)return;STATE.pin+=n;this.updateDots();if(STATE.pin.length===4)setTimeout(()=>this.verifyPin(),100)},
backspace(){STATE.pin=STATE.pin.slice(0,-1);this.updateDots()},
clear(){STATE.pin='';this.updateDots();document.getElementById('login-error').textContent=''},
updateDots(){document.querySelectorAll('.pin-dot').forEach((d,i)=>d.classList.toggle('filled',i<STATE.pin.length))},
verifyPin(){const s=localStorage.getItem(K.PIN);if(STATE.pin===s){this.showApp()}else{document.getElementById('login-error').textContent='Onjuiste PIN';document.querySelector('#login-screen .auth-box').classList.add('shake');setTimeout(()=>{document.querySelector('#login-screen .auth-box').classList.remove('shake');this.clear()},400)}},
clearPin(){STATE.pin='';this.updateDots();document.getElementById('login-error').textContent=''},
completeSetup(){const n=document.getElementById('setup-name').value.trim();const p=document.getElementById('setup-pin').value;const c=document.getElementById('setup-pin-confirm').value;const e=document.getElementById('setup-error');if(!n){e.textContent='Voer uw naam in';return}if(!/^\d{4}$/.test(p)){e.textContent='PIN moet 4 cijfers zijn';return}if(p!==c){e.textContent='PIN komt niet overeen';return}localStorage.setItem(K.PIN,p);localStorage.setItem(K.USER,n);localStorage.setItem(K.DATA,'[]');this.showApp();toast('Account aangemaakt!','success')}
};

function initSpeech(){const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SR){document.getElementById('browser-warning').classList.remove('hidden');document.getElementById('record-btn').disabled=true;return}
const ua=navigator.userAgent;if(!/Chrome|Edg/i.test(ua)){document.getElementById('browser-warning').classList.remove('hidden')}
STATE.recognition=new SR();STATE.recognition.continuous=true;STATE.recognition.interimResults=true;STATE.recognition.lang='nl-NL';
let finalTranscript='';
STATE.recognition.onresult=(e)=>{let interim='';for(let i=e.resultIndex;i<e.results.length;i++){const t=e.results[i][0].transcript;if(e.results[i].isFinal){finalTranscript+=t+' '}else{interim+=t}}
const ta=document.getElementById('interview-transcript');ta.value=finalTranscript+interim;document.getElementById('word-count').textContent=countWords(ta.value)+' woorden'};
STATE.recognition.onerror=(e)=>{if(e.error!=='no-speech'){toast('Spraakherkenning fout: '+e.error,'error');stopRecording()}};
STATE.recognition.onend=()=>{if(STATE.recording){STATE.recognition.start()}}}
function toggleRecording(){if(STATE.recording){stopRecording()}else{startRecording()}}
function startRecording(){if(!STATE.recognition){toast('Spraakherkenning niet beschikbaar','error');return}
const btn=document.getElementById('record-btn');btn.className='record-btn recording';btn.innerHTML='<i class="fas fa-stop"></i> <span>Stop Opname</span>';STATE.recording=true;STATE.recognition.start()}
function stopRecording(){const btn=document.getElementById('record-btn');btn.className='record-btn idle';btn.innerHTML='<i class="fas fa-microphone"></i> <span>Start Opname</span>';STATE.recording=false;if(STATE.recognition){STATE.recognition.stop()}}
function loadData(){try{const d=localStorage.getItem(K.DATA);STATE.interviews=d?JSON.parse(d):[]}catch(e){STATE.interviews=[]}}
function saveData(){localStorage.setItem(K.DATA,JSON.stringify(STATE.interviews))}
function switchTab(t){document.querySelectorAll('.nav-tab').forEach(n=>n.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(n=>n.classList.remove('active'));document.querySelector(`.nav-tab[data-tab="${t}"]`).classList.add('active');document.getElementById('tab-'+t).classList.add('active');if(t!=='interview'&&STATE.recording){stopRecording()}}
function updateUI(){updateStats();updateRecent();updateAll()}
function updateStats(){document.getElementById('stat-count').textContent=STATE.interviews.length;const words=STATE.interviews.reduce((s,i)=>s+countWords(i.transcript),0);document.getElementById('stat-words').textContent=words}
function renderInterview(i){const dt=new Date(i.createdAt).toLocaleDateString('nl-NL',{day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'});const words=countWords(i.transcript);return`<div class="interview-item"><div class="interview-item-header"><span class="interview-item-name"><i class="fas fa-user"></i> ${esc(i.naam)}</span><span class="interview-item-date">${dt}</span></div>${i.onderwerp?`<div class="interview-item-meta">${esc(i.onderwerp)}</div>`:''}<div class="interview-item-meta">${words} woorden</div></div>`}
function updateRecent(){const c=document.getElementById('recent-list');const r=STATE.interviews.slice(0,5);if(!r.length){c.innerHTML='<div class="empty-state"><i class="fas fa-microphone-alt-slash"></i><p>Nog geen interviews</p></div>';return}c.innerHTML=r.map(renderInterview).join('')}
function updateAll(){const c=document.getElementById('all-list');if(!STATE.interviews.length){c.innerHTML='<div class="empty-state"><i class="fas fa-microphone-alt-slash"></i><p>Nog geen interviews</p></div>';return}c.innerHTML=STATE.interviews.map(renderInterview).join('')}
function saveInterview(){const naam=document.getElementById('interview-naam').value.trim();const onderwerp=document.getElementById('interview-onderwerp').value.trim();const transcript=document.getElementById('interview-transcript').value.trim();if(!naam){toast('Naam verplicht','error');return}if(!transcript){toast('Geen transcriptie aanwezig','error');return}if(STATE.recording){stopRecording()}
const interview={id:Date.now().toString(36)+Math.random().toString(36).substr(2,5),naam,onderwerp,transcript,wordCount:countWords(transcript),createdAt:new Date().toISOString()};STATE.interviews.unshift(interview);saveData();updateUI();document.getElementById('interview-naam').value='';document.getElementById('interview-onderwerp').value='';document.getElementById('interview-transcript').value='';document.getElementById('word-count').textContent='0 woorden';toast('Interview opgeslagen','success');switchTab('dashboard')}
function exportJSON(){if(!STATE.interviews.length){toast('Geen data','error');return}const data={type:'bibob-interview',version:'1.0.0',interviewer:STATE.user,exportDatum:new Date().toISOString(),interviews:STATE.interviews};download(JSON.stringify(data,null,2),`bibob_interviews_${new Date().toISOString().split('T')[0]}.json`,'application/json');toast('Geëxporteerd','success')}
function saveSettings(){const n=document.getElementById('settings-name').value.trim();if(!n){toast('Naam verplicht','error');return}localStorage.setItem(K.USER,n);STATE.user=n;document.getElementById('display-user').textContent=esc(n);toast('Opgeslagen','success')}
function changePin(){const p=prompt('Nieuwe 4-cijferige PIN:');if(p&&/^\d{4}$/.test(p)){localStorage.setItem(K.PIN,p);toast('PIN gewijzigd','success')}else if(p){toast('PIN moet 4 cijfers zijn','error')}}
function logout(){if(confirm('Uitloggen?')){if(STATE.recording)stopRecording();Auth.showLogin();toast('Uitgelogd','info')}}
document.addEventListener('DOMContentLoaded',()=>{Auth.init();document.querySelectorAll('.nav-tab').forEach(t=>t.addEventListener('click',()=>switchTab(t.dataset.tab)));document.getElementById('interview-transcript').addEventListener('input',function(){document.getElementById('word-count').textContent=countWords(this.value)+' woorden'})});
if('serviceWorker' in navigator){navigator.serviceWorker.register('./sw.js').catch(e=>console.error('SW:',e))}
</script>
</body>
</html>
